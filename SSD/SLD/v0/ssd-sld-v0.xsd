<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
    xmlns:esldoscd="https://openscd.org/SCL/SSD/SLD/v0" targetNamespace="https://openscd.org/SCL/SSD/SLD/v0" elementFormDefault="qualified" attributeFormDefault="qualified" version="0.0.1">

    <xs:annotation>
        <xs:documentation>
            OpenSCD Single Line Diagram (SLD) extension namespace for IEC 61850 SCL.
            This namespace defines elements to be used within SCL Private sections for 
            positioning and rendering process elements and functions in a single line 
            diagram representation of substations to enable interoperable graphical displays.
        </xs:documentation>
    </xs:annotation>

    <!-- Simple Types -->

    <xs:simpleType name="tTransformerKind">
        <xs:annotation>
            <xs:documentation>Marked special transformer</xs:documentation>
        </xs:annotation>
        <xs:restriction base="xs:string">
            <xs:enumeration value="auto"/>
            <xs:enumeration value="earthing"/>
        </xs:restriction>
    </xs:simpleType>

    <xs:simpleType name="tColor">
        <xs:union>
            <!-- Named colors and keywords -->
            <xs:simpleType>
            <xs:restriction base="xs:string">
                <!-- Basic colors -->
                <xs:enumeration value="black"/>
                <xs:enumeration value="white"/>
                <xs:enumeration value="red"/>
                <xs:enumeration value="green"/>
                <xs:enumeration value="blue"/>
                <xs:enumeration value="yellow"/>
                <xs:enumeration value="gray"/>
                <xs:enumeration value="silver"/>
                <xs:enumeration value="maroon"/>
                <xs:enumeration value="olive"/>
                <xs:enumeration value="lime"/>
                <xs:enumeration value="aqua"/>
                <xs:enumeration value="teal"/>
                <xs:enumeration value="navy"/>
                <xs:enumeration value="fuchsia"/>
                <xs:enumeration value="purple"/>
                
                <!-- Extended color keywords -->
                <xs:enumeration value="transparent"/>
                <xs:enumeration value="aliceblue" />
                <xs:enumeration value="antiquewhite" />
                <xs:enumeration value="aqua" />
                <xs:enumeration value="aquamarine" />
                <xs:enumeration value="azure" />
                <xs:enumeration value="beige" />
                <xs:enumeration value="bisque" />
                <xs:enumeration value="black" />
                <xs:enumeration value="blanchedalmond" />
                <xs:enumeration value="blue" />
                <xs:enumeration value="blueviolet" />
                <xs:enumeration value="brown" />
                <xs:enumeration value="burlywood" />
                <xs:enumeration value="cadetblue" />
                <xs:enumeration value="chartreuse" />
                <xs:enumeration value="chocolate" />
                <xs:enumeration value="coral" />
                <xs:enumeration value="cornflowerblue" />
                <xs:enumeration value="cornsilk" />
                <xs:enumeration value="crimson" />
                <xs:enumeration value="cyan" />
                <xs:enumeration value="darkblue" />
                <xs:enumeration value="darkcyan" />
                <xs:enumeration value="darkgoldenrod" />
                <xs:enumeration value="darkgray" />
                <xs:enumeration value="darkgreen" />
                <xs:enumeration value="darkgrey" />
                <xs:enumeration value="darkkhaki" />
                <xs:enumeration value="darkmagenta" />
                <xs:enumeration value="darkolivegreen" />
                <xs:enumeration value="darkorange" />
                <xs:enumeration value="darkorchid" />
                <xs:enumeration value="darkred" />
                <xs:enumeration value="darksalmon" />
                <xs:enumeration value="darkseagreen" />
                <xs:enumeration value="darkslateblue" />
                <xs:enumeration value="darkslategray" />
                <xs:enumeration value="darkslategrey" />
                <xs:enumeration value="darkturquoise" />
                <xs:enumeration value="darkviolet" />
                <xs:enumeration value="deeppink" />
                <xs:enumeration value="deepskyblue" />
                <xs:enumeration value="dimgray" />
                <xs:enumeration value="dimgrey" />
                <xs:enumeration value="dodgerblue" />
                <xs:enumeration value="firebrick" />
                <xs:enumeration value="floralwhite" />
                <xs:enumeration value="forestgreen" />
                <xs:enumeration value="fuchsia" />
                <xs:enumeration value="gainsboro" />
                <xs:enumeration value="ghostwhite" />
                <xs:enumeration value="gold" />
                <xs:enumeration value="goldenrod" />
                <xs:enumeration value="gray" />
                <xs:enumeration value="green" />
                <xs:enumeration value="greenyellow" />
                <xs:enumeration value="grey" />
                <xs:enumeration value="honeydew" />
                <xs:enumeration value="hotpink" />
                <xs:enumeration value="indianred" />
                <xs:enumeration value="indigo" />
                <xs:enumeration value="ivory" />
                <xs:enumeration value="khaki" />
                <xs:enumeration value="lavender" />
                <xs:enumeration value="lavenderblush" />
                <xs:enumeration value="lawngreen" />
                <xs:enumeration value="lemonchiffon" />
                <xs:enumeration value="lightblue" />
                <xs:enumeration value="lightcoral" />
                <xs:enumeration value="lightcyan" />
                <xs:enumeration value="lightgoldenrodyellow" />
                <xs:enumeration value="lightgray" />
                <xs:enumeration value="lightgreen" />
                <xs:enumeration value="lightgrey" />
                <xs:enumeration value="lightpink" />
                <xs:enumeration value="lightsalmon" />
                <xs:enumeration value="lightseagreen" />
                <xs:enumeration value="lightskyblue" />
                <xs:enumeration value="lightslategray" />
                <xs:enumeration value="lightslategrey" />
                <xs:enumeration value="lightsteelblue" />
                <xs:enumeration value="lightyellow" />
                <xs:enumeration value="lime" />
                <xs:enumeration value="limegreen" />
                <xs:enumeration value="linen" />
                <xs:enumeration value="magenta" />
                <xs:enumeration value="maroon" />
                <xs:enumeration value="mediumaquamarine" />
                <xs:enumeration value="mediumblue" />
                <xs:enumeration value="mediumorchid" />
                <xs:enumeration value="mediumpurple" />
                <xs:enumeration value="mediumseagreen" />
                <xs:enumeration value="mediumslateblue" />
                <xs:enumeration value="mediumspringgreen" />
                <xs:enumeration value="mediumturquoise" />
                <xs:enumeration value="mediumvioletred" />
                <xs:enumeration value="midnightblue" />
                <xs:enumeration value="mintcream" />
                <xs:enumeration value="mistyrose" />
                <xs:enumeration value="moccasin" />
                <xs:enumeration value="navajowhite" />
                <xs:enumeration value="navy" />
                <xs:enumeration value="oldlace" />
                <xs:enumeration value="olive" />
                <xs:enumeration value="olivedrab" />
                <xs:enumeration value="orange" />
                <xs:enumeration value="orangered" />
                <xs:enumeration value="orchid" />
                <xs:enumeration value="palegoldenrod" />
                <xs:enumeration value="palegreen" />
                <xs:enumeration value="paleturquoise" />
                <xs:enumeration value="palevioletred" />
                <xs:enumeration value="papayawhip" />
                <xs:enumeration value="peachpuff" />
                <xs:enumeration value="peru" />
                <xs:enumeration value="pink" />
                <xs:enumeration value="plum" />
                <xs:enumeration value="powderblue" />
                <xs:enumeration value="purple" />
                <xs:enumeration value="rebeccapurple" />
                <xs:enumeration value="red" />
                <xs:enumeration value="rosybrown" />
                <xs:enumeration value="royalblue" />
                <xs:enumeration value="saddlebrown" />
                <xs:enumeration value="salmon" />
                <xs:enumeration value="sandybrown" />
                <xs:enumeration value="seagreen" />
                <xs:enumeration value="seashell" />
                <xs:enumeration value="sienna" />
                <xs:enumeration value="silver" />
                <xs:enumeration value="skyblue" />
                <xs:enumeration value="slateblue" />
                <xs:enumeration value="slategray" />
                <xs:enumeration value="slategrey" />
                <xs:enumeration value="snow" />
                <xs:enumeration value="springgreen" />
                <xs:enumeration value="steelblue" />
                <xs:enumeration value="tan" />
                <xs:enumeration value="teal" />
                <xs:enumeration value="thistle" />
                <xs:enumeration value="tomato" />
                <xs:enumeration value="turquoise" />
                <xs:enumeration value="violet" />
                <xs:enumeration value="wheat" />
                <xs:enumeration value="white" />
                <xs:enumeration value="whitesmoke" />
                <xs:enumeration value="yellow" />
                <xs:enumeration value="yellowgreen" />
            </xs:restriction>
            </xs:simpleType>


            <!-- Hexadecimal colors (#RGB, #RRGGBB, #RRGGBBAA, etc.) -->
            <xs:simpleType>
            <xs:restriction base="xs:string">
                <xs:pattern value="#([0-9a-fA-F]{3,4}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})"/>
            </xs:restriction>
            </xs:simpleType>

            <!-- Functional RGB/RGBA notations -->
            <xs:simpleType>
            <xs:restriction base="xs:string">
                <xs:pattern value="rgb\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*\)"/>
            </xs:restriction>
            </xs:simpleType>

            <xs:simpleType>
            <xs:restriction base="xs:string">
                <xs:pattern value="rgba\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*(0|0?\.\d+|1(\.0)?)\s*\)"/>
            </xs:restriction>
            </xs:simpleType>

            <!-- Functional HSL/HSLA notations -->
            <xs:simpleType>
            <xs:restriction base="xs:string">
                <xs:pattern value="hsl\(\s*\d{1,3}\s*,\s*\d{1,3}%\s*,\s*\d{1,3}%\s*\)"/>
            </xs:restriction>
            </xs:simpleType>

            <xs:simpleType>
            <xs:restriction base="xs:string">
                <xs:pattern value="hsla\(\s*\d{1,3}\s*,\s*\d{1,3}%\s*,\s*\d{1,3}%\s*,\s*(0|0?\.\d+|1(\.0)?)\s*\)"/>
            </xs:restriction>
            </xs:simpleType>
        </xs:union>
    </xs:simpleType>

    <xs:simpleType name="tFontWeight">
        <xs:annotation>
            <xs:documentation>Font weight for text rendering (100-900)</xs:documentation>
        </xs:annotation>
        <xs:restriction base="xs:integer">
            <xs:minInclusive value="100"/>
            <xs:maxInclusive value="900"/>
        </xs:restriction>
    </xs:simpleType>

    <!-- Complex Types for Private Elements -->

    <xs:complexType name="tSLDAttributes">
        <xs:annotation>
            <xs:documentation>
                SLD coordinate and dimension data to be stored in Private elements.
                Intended to be used as a child of Private/@type="OpenSCD-SLD-Layout".
            </xs:documentation>
        </xs:annotation>
        <xs:attribute name="x" type="xs:decimal" use="optional">
            <xs:annotation>
                <xs:documentation>X-coordinate position in grid units</xs:documentation>
            </xs:annotation>
        </xs:attribute>

        <xs:attribute name="y" type="xs:decimal" use="optional">
            <xs:annotation>
                <xs:documentation>Y-coordinate position in grid units</xs:documentation>
            </xs:annotation>
        </xs:attribute>

        <xs:attribute name="w" type="xs:decimal" use="optional" default="1">
            <xs:annotation>
                <xs:documentation>Width in grid units</xs:documentation>
            </xs:annotation>
        </xs:attribute>

        <xs:attribute name="h" type="xs:decimal" use="optional" default="1">
            <xs:annotation>
                <xs:documentation>Height in grid units</xs:documentation>
            </xs:annotation>
        </xs:attribute>

        <xs:attribute name="lx" type="xs:decimal" use="optional">
            <xs:annotation>
                <xs:documentation>Label X-coordinate offset in grid units</xs:documentation>
            </xs:annotation>
        </xs:attribute>

        <xs:attribute name="ly" type="xs:decimal" use="optional">
            <xs:annotation>
                <xs:documentation>Label Y-coordinate offset in grid units</xs:documentation>
            </xs:annotation>
        </xs:attribute>

        <xs:attribute name="rot" type="xs:decimal" use="optional" default="0">
            <xs:annotation>
                <xs:documentation>Rotation: 0=0°, 0.5=45° 1=90°, 2=180°, 3=270°</xs:documentation>
            </xs:annotation>
        </xs:attribute>

        <xs:attribute name="flip" type="xs:boolean" use="optional" default="false">
            <xs:annotation>
                <xs:documentation>Whether the equipment is flipped/mirrored</xs:documentation>
            </xs:annotation>
        </xs:attribute>

        <xs:attribute name="color" type="esldoscd:tColor" use="optional" default="#000">
            <xs:annotation>
                <xs:documentation>Color for text rendering</xs:documentation>
            </xs:annotation>
        </xs:attribute>

        <xs:attribute name="weight" type="esldoscd:tFontWeight" use="optional" default="300">
            <xs:annotation>
                <xs:documentation>Font weight for text rendering (100-900)</xs:documentation>
            </xs:annotation>
        </xs:attribute>

        <xs:attribute name="kind" type="esldoscd:tTransformerKind" use="optional">
            <xs:annotation>
                <xs:documentation>Type of transformer for specialized rendering</xs:documentation>
            </xs:annotation>
        </xs:attribute>

        <xs:attribute name="uuid" type="xs:string" use="optional">
            <xs:annotation>
                <xs:documentation>Unique identifier for the Terminal element</xs:documentation>
            </xs:annotation>
        </xs:attribute>
    </xs:complexType>

    <!-- Elements for use in Private sections -->

    <xs:element name="SLDAttributes" type="esldoscd:tSLDAttributes">
        <xs:annotation>
            <xs:documentation>
                Root element containing SLD positioning and styling data.
                To be used within SCL Private elements.
                
                Example usage:
                &lt;Private type="OpenSCD-SLD-Layout"&gt;
                    &lt;esldoscd:SLDAttributes esldoscd:x="10" esldoscd:y="5" esldoscd:w="2" esldoscd:h="3" esldoscd:rot="1" esldoscd:color="#FF0000"/&gt;
                &lt;/Private&gt;
            </xs:documentation>
        </xs:annotation>
    </xs:element>

    <xs:element name="Section">
        <xs:annotation>
            <xs:documentation>
                Defines a section of a connectivity node with vertices.
                Can be marked as a busbar for different rendering.
                
                Example usage:
                &lt;Private type="OpenSCD-SLD-Layout"&gt;
                    &lt;esldoscd:Section esldoscd:bus="true"&gt;
                        &lt;esldoscd:Vertex esldoscd:x="10.5" esldoscd:y="20.3"/&gt;
                        &lt;esldoscd:Vertex esldoscd:x="10.5" esldoscd:y="25.3"/&gt;
                    &lt;/esldoscd:Section&gt;
                &lt;/Private&gt;
            </xs:documentation>
        </xs:annotation>
        <xs:complexType>
            <xs:sequence>
                <xs:element name="Vertex" minOccurs="0" maxOccurs="unbounded">
                    <xs:complexType>
                        <xs:attribute name="x" type="xs:decimal" use="required"/>
                        <xs:attribute name="y" type="xs:decimal" use="required"/>
                        <xs:attribute name="uuid" type="xs:string" use="optional">
                            <xs:annotation>
                                <xs:documentation>Unique identifier referencing the a Terminal</xs:documentation>
                            </xs:annotation>
                        </xs:attribute>
                    </xs:complexType>
                </xs:element>
            </xs:sequence>
            <xs:attribute name="bus" type="xs:boolean" use="optional" default="false">
                <xs:annotation>
                    <xs:documentation>Indicates if this section is a busbar (renders with thicker lines)</xs:documentation>
                </xs:annotation>
            </xs:attribute>
        </xs:complexType>
    </xs:element>

</xs:schema>
